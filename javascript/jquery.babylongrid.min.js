/*
 *  Project: Babylon Grid
 *  Version: 1.1
 *  Description: Lightweight jQuery + CSS plugin for creating responsive, dynamic & customizable pinterest like grid with diferent colun width support and few display mods.
 *  Author: Marek Fajkus @turbo_MaCk (http://marekrocks.it)
 *  License: MIT
 */(function(e,t,n){var r="babylongrid",i={scheme:[{minWidth:960,columns:4},{minWidth:720,columns:3},{minWidth:550,columns:2},{minWidth:0,columns:1}],display:null,firstToRight:!1,heightDivisor:50},s=function(n,s){this.element=n;this.options=e.extend({},i,s);this._defaults=i;this._name=r;this.init()};s.prototype={init:function(){var n=this;e(this.element).wrapInner('<div class="babylongrid-container" />');this.casheElements();this._setGrid();e(t).resize(function(){n._setGrid()})},casheElements:function(){var t=e(this.element),n=t.children(".babylongrid-container"),r=n.children();this.cashed={element:t,container:n,articles:r}},_setGrid:function(){var t=this.cashed.container,n=t.width(),r,i,s=this;e.each(this.options.scheme,function(){if(this.minWidth<=n){i=this.columns;r="container-"+i;if(!t.hasClass(r)){t.removeClass().addClass("babylongrid-container").addClass(r);s._setColumns(i)}return!1}})},_setColumns:function(e){var t=this.cashed.container,n;t.children(".column").remove();for(var r=1;r<=e;r++){n='<div class="column column-'+r+'"></div>';t.append(n)}t.children(".column").data("height",0);this._organizeArticles(e)},_organizeArticles:function(t){var n=this.cashed.articles,r,i=this.cashed.container,s=i.children(".column"),o=s.data("height")+1,u,a,f,l=this;l.options.display&&i.removeClass("tower").removeClass("city");l.options.firstToRight&&s.filter(".column-"+t).data("height",-1);e.each(n,function(c){r=e(this);e.each(s,function(n){if(e(this).data("height")<o){o=e(this).data("height");u=e(this)}if(n+1>=t){u.append(r);l.options.heightDivisor>1&&l._setArticleHeight(r);a=u.outerHeight(!0);u.data("height",a);o=a+1;f=u}});l.options.display&&c+1===n.length&&(l.options.display==="tower"?i.addClass("tower"):l.options.display==="city"&&i.addClass("city"))})},_setArticleHeight:function(e){var t=this.options.heightDivisor,n=e.height(),r=n%t;r>0&&e.height(n+t-r)}};e.fn[r]=function(t){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new s(this,t))})}})(jQuery,window);