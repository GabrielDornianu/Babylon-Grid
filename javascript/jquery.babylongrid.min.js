!function(i,t,e){var s="babylongrid",n={scheme:[{minWidth:960,columns:4},{minWidth:720,columns:3},{minWidth:550,columns:2},{minWidth:0,columns:1}],display:null,firstToRight:!1,heightDivisor:25},h=function a(t,e){this.element=t,this.options=i.extend({},n,e),this._defaults=n,this._name=s,this.init()};h.prototype={init:function(){var e=this;i(e.element).wrapInner('<div class="babylongrid-container" />'),e.casheElements(),e._setGrid(),i(t).resize(function(){e._setGrid()}),i(this.element).on("babylongrid:resize",function(){e._setGrid()})},casheElements:function(){var t=i(this.element),e=t.children(".babylongrid-container"),s=e.children();this.cashed={element:t,container:e,articles:s}},_setGrid:function(){var t=this.cashed.container,e=t.width(),s,n,h=this;i.each(this.options.scheme,function(){return this.minWidth<=e?(n=this.columns,s="container-"+n,t.hasClass(s)?h._resizeArticles():(t.removeClass().addClass("babylongrid-container").addClass(s),h._setColumns(n)),!1):void 0})},_setColumns:function(i){var t=this.cashed.container,e;t.children(".column").remove();for(var s=1;i>=s;s++)e='<div class="column column-'+s+'"></div>',t.append(e);t.children(".column").data("height",0),this._organizeArticles(i)},_organizeArticles:function(t){var e=this.cashed.articles,s,n=this.cashed.container,h=n.children(".column"),a=h.data("height")+1,o,c,r,l=this;l.options.display&&n.removeClass("tower").removeClass("city"),l.options.firstToRight&&h.filter(".column-"+t).data("height",-1),i.each(e,function(d){s=i(this),i.each(h,function(e){i(this).data("height")<a&&(a=i(this).data("height"),o=i(this)),e+1>=t&&(o.append(s),l.options.heightDivisor>1&&l._setArticleHeight(s),c=o.outerHeight(!0),o.data("height",c),a=c+1,r=o)}),d+1===e.length&&("hidden"===l.cashed.element.css("visibility")&&l.cashed.element.css("visibility","visible"),l.options.display&&("tower"===l.options.display?n.addClass("tower"):"city"===l.options.display&&n.addClass("city")))})},_setArticleHeight:function(i){i.removeAttr("style");var t=this.options.heightDivisor,e=i.height(),s=e%t;s>0&&i.height(e+t-s)},_resizeArticles:function(){var t=this;i.each(t.cashed.articles,function(){t._setArticleHeight(i(this))})}},i.fn[s]=function(t){return this.each(function(){i.data(this,"plugin_"+s)||i.data(this,"plugin_"+s,new h(this,t))})}}(jQuery,window);